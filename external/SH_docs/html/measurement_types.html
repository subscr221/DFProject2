<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BB API: Measurement Types</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="sh-logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">BB API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Measurement Types </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#sweepMode">Swept Spectrum Analysis</a><ul><li class="level2"><a href="#autotoc_md36">Example</a></li>
<li class="level2"><a href="#autotoc_md37">Configuration</a></li>
<li class="level2"><a href="#autotoc_md38">Usage</a></li>
</ul>
</li>
<li class="level1"><a href="#realTimeAnalysis">Real-Time Spectrum Analysis</a><ul><li class="level2"><a href="#autotoc_md39">Example</a></li>
<li class="level2"><a href="#autotoc_md40">Configuration</a></li>
<li class="level2"><a href="#autotoc_md41">Usage</a></li>
</ul>
</li>
<li class="level1"><a href="#IQStreaming">I/Q Streaming</a><ul><li class="level2"><a href="#autotoc_md42">Example</a></li>
<li class="level2"><a href="#autotoc_md43">Configuration</a></li>
<li class="level2"><a href="#autotoc_md44">Usage</a></li>
<li class="level2"><a href="#autotoc_md45">External Triggering</a><ul><li class="level3"><a href="#autotoc_md46">Example</a></li>
<li class="level3"><a href="#autotoc_md47">Usage</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#audioDemod">Audio Demodulation</a><ul><li class="level2"><a href="#autotoc_md48">Example</a></li>
<li class="level2"><a href="#autotoc_md49">Configuration</a></li>
<li class="level2"><a href="#autotoc_md50">Usage</a></li>
</ul>
</li>
<li class="level1"><a href="#snaMode">Scalar Network Analysis</a><ul><li class="level2"><a href="#autotoc_md51">Example</a></li>
<li class="level2"><a href="#autotoc_md52">Configuration and Usage</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p ><a class="anchor" id="md_C__Users_Roger_Documents_Dev_Checkout_BB_API_docs_page_measurement_types"></a></p>
<p >Please also see the C++ programming examples for an example of interfacing the device for each measurement type.</p>
<h1><a class="anchor" id="sweepMode"></a>
Swept Spectrum Analysis</h1>
<p >Swept analysis represents the most traditional form of spectrum analysis. This mode offers the largest amount of configuration options and returns traditional frequency domain sweeps. A frequency domain sweep displays amplitude on the vertical axis and frequency on the horizontal axis.</p>
<h2><a class="anchor" id="autotoc_md36"></a>
Example</h2>
<p >For a list of all examples, please see the <em>examples/</em> folder in the SDK.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="bb__api_8h.html">bb_api.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><span class="preprocessor">#pragma comment(lib, &quot;bb_api.lib&quot;</span>)</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">This example demonstrates using the API to perform a sweep</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> bbExampleSweep()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> handle;</div>
<div class="line">    <a class="code hl_enumeration" href="bb__api_8h.html#abc8751772e5c7903c5b223fa8a239fca">bbStatus</a> status = <a class="code hl_function" href="bb__api_8h.html#ab92ec1dec31d08f9a77d6ab057f4dd07">bbOpenDevice</a>(&amp;handle);</div>
<div class="line">    <span class="keywordflow">if</span>(status != <a class="code hl_enumvalue" href="bb__api_8h.html#abc8751772e5c7903c5b223fa8a239fcaa3c1a69b8400242534b2b1b07d08bfa16">bbNoError</a>) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Issue opening device\n&quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <a class="code hl_function" href="bb__api_8h.html#ab8b68101c30b2c38dd455fa7cfc90a2c">bbGetErrorString</a>(status) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Configure a sweep from 850MHz to 950MHz with a 10kHz</span></div>
<div class="line">    <span class="comment">//  RBW/VBW and an expected input of at most -20dBm.</span></div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#aef095decdcc0c3d5d8cb8c0e962dafae">bbConfigureRefLevel</a>(handle, -20.0);</div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a82beee523def2bd762445a4495cd5373">bbConfigureCenterSpan</a>(handle, 900.0e6, 100.0e6);</div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a80f48f1526f2b51ada3f6b3fbaa2393e">bbConfigureSweepCoupling</a>(handle, 10.0e3, 10.0e3, 0.001, <a class="code hl_define" href="bb__api_8h.html#a7f2644ea86cca89a2df9de212014906f">BB_RBW_SHAPE_FLATTOP</a>, <a class="code hl_define" href="bb__api_8h.html#a242c2ee31b8fe7b53d5a74a231bba8de">BB_NO_SPUR_REJECT</a>);</div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a6ecdc66c72d6384b465b5bcaf6f4cd98">bbConfigureAcquisition</a>(handle, <a class="code hl_define" href="bb__api_8h.html#a3a31af38dd3115e270fa365f12cea946">BB_AVERAGE</a>, <a class="code hl_define" href="bb__api_8h.html#a5026e49fcacdadadb54742865e945d64">BB_LOG_SCALE</a>);</div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a6576bc394c4a1c831231f14dd4b82490">bbConfigureProcUnits</a>(handle, <a class="code hl_define" href="bb__api_8h.html#a903a925cc8d037cb82422bb47a9b3872">BB_POWER</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Configuration complete, initialize the device</span></div>
<div class="line">    status = <a class="code hl_function" href="bb__api_8h.html#a94837e7f5ac6882499f46db29bbc0427">bbInitiate</a>(handle, <a class="code hl_define" href="bb__api_8h.html#aad4b52476a49e0f2e8134f320d79b1a8">BB_SWEEPING</a>, 0);</div>
<div class="line">    <span class="keywordflow">if</span>(status &lt; <a class="code hl_enumvalue" href="bb__api_8h.html#abc8751772e5c7903c5b223fa8a239fcaa3c1a69b8400242534b2b1b07d08bfa16">bbNoError</a>) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Error configuring device\n&quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <a class="code hl_function" href="bb__api_8h.html#ab8b68101c30b2c38dd455fa7cfc90a2c">bbGetErrorString</a>(status);</div>
<div class="line">        exit(-1);</div>
<div class="line">    } </div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get sweep characteristics and allocate memory for sweep</span></div>
<div class="line">    uint32_t sweepSize;</div>
<div class="line">    <span class="keywordtype">double</span> binSize, startFreq;</div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a71b1e19fca5baaed630eaf31ab9055cd">bbQueryTraceInfo</a>(handle, &amp;sweepSize, &amp;binSize, &amp;startFreq);</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;float&gt; sweep(sweepSize);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get the sweep</span></div>
<div class="line">    <span class="comment">// Pass NULL for the min parameter. For most scenarios, the min sweep can be ignored.</span></div>
<div class="line">    status = <a class="code hl_function" href="bb__api_8h.html#af50673d6cd1415224bb3200602f0cb56">bbFetchTrace_32f</a>(handle, sweepSize, 0, sweep.data());</div>
<div class="line">    <span class="keywordflow">if</span>(status != <a class="code hl_enumvalue" href="bb__api_8h.html#abc8751772e5c7903c5b223fa8a239fcaa3c1a69b8400242534b2b1b07d08bfa16">bbNoError</a>) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Sweep status: &quot;</span> &lt;&lt; <a class="code hl_function" href="bb__api_8h.html#ab8b68101c30b2c38dd455fa7cfc90a2c">bbGetErrorString</a>(status) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// If the sweep status is not an error, the sweep is now stored in the sweep</span></div>
<div class="line">    <span class="comment">//   vector. The frequency of the first index in the vector is startFreq.</span></div>
<div class="line">    <span class="comment">// To get the frequency of any bin in the vector use the equation</span></div>
<div class="line">    <span class="comment">// freqHz = startFreq + binSize * index;</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// From this point, you can continue to get sweeps with this configuration</span></div>
<div class="line">    <span class="comment">//   by calling bbFetchTrace again, or reconfigure and initiate the</span></div>
<div class="line">    <span class="comment">//   device for a new sweep configuration.</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Finished/close device</span></div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a6dc895bf3e792c37ee5dbddf37166bb5">bbAbort</a>(handle);</div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#ac19bb704f9607149f4a8cb9d725f5d1c">bbCloseDevice</a>(handle);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="ttc" id="abb__api_8h_html"><div class="ttname"><a href="bb__api_8h.html">bb_api.h</a></div><div class="ttdoc">API functions for the BB60 spectrum analyzers.</div></div>
<div class="ttc" id="abb__api_8h_html_a242c2ee31b8fe7b53d5a74a231bba8de"><div class="ttname"><a href="bb__api_8h.html#a242c2ee31b8fe7b53d5a74a231bba8de">BB_NO_SPUR_REJECT</a></div><div class="ttdeci">#define BB_NO_SPUR_REJECT</div><div class="ttdef"><b>Definition:</b> bb_api.h:141</div></div>
<div class="ttc" id="abb__api_8h_html_a3a31af38dd3115e270fa365f12cea946"><div class="ttname"><a href="bb__api_8h.html#a3a31af38dd3115e270fa365f12cea946">BB_AVERAGE</a></div><div class="ttdeci">#define BB_AVERAGE</div><div class="ttdef"><b>Definition:</b> bb_api.h:164</div></div>
<div class="ttc" id="abb__api_8h_html_a5026e49fcacdadadb54742865e945d64"><div class="ttname"><a href="bb__api_8h.html#a5026e49fcacdadadb54742865e945d64">BB_LOG_SCALE</a></div><div class="ttdeci">#define BB_LOG_SCALE</div><div class="ttdef"><b>Definition:</b> bb_api.h:146</div></div>
<div class="ttc" id="abb__api_8h_html_a6576bc394c4a1c831231f14dd4b82490"><div class="ttname"><a href="bb__api_8h.html#a6576bc394c4a1c831231f14dd4b82490">bbConfigureProcUnits</a></div><div class="ttdeci">BB_API bbStatus bbConfigureProcUnits(int device, uint32_t units)</div></div>
<div class="ttc" id="abb__api_8h_html_a6dc895bf3e792c37ee5dbddf37166bb5"><div class="ttname"><a href="bb__api_8h.html#a6dc895bf3e792c37ee5dbddf37166bb5">bbAbort</a></div><div class="ttdeci">BB_API bbStatus bbAbort(int device)</div></div>
<div class="ttc" id="abb__api_8h_html_a6ecdc66c72d6384b465b5bcaf6f4cd98"><div class="ttname"><a href="bb__api_8h.html#a6ecdc66c72d6384b465b5bcaf6f4cd98">bbConfigureAcquisition</a></div><div class="ttdeci">BB_API bbStatus bbConfigureAcquisition(int device, uint32_t detector, uint32_t scale)</div></div>
<div class="ttc" id="abb__api_8h_html_a71b1e19fca5baaed630eaf31ab9055cd"><div class="ttname"><a href="bb__api_8h.html#a71b1e19fca5baaed630eaf31ab9055cd">bbQueryTraceInfo</a></div><div class="ttdeci">BB_API bbStatus bbQueryTraceInfo(int device, uint32_t *traceLen, double *binSize, double *start)</div></div>
<div class="ttc" id="abb__api_8h_html_a7f2644ea86cca89a2df9de212014906f"><div class="ttname"><a href="bb__api_8h.html#a7f2644ea86cca89a2df9de212014906f">BB_RBW_SHAPE_FLATTOP</a></div><div class="ttdeci">#define BB_RBW_SHAPE_FLATTOP</div><div class="ttdef"><b>Definition:</b> bb_api.h:157</div></div>
<div class="ttc" id="abb__api_8h_html_a80f48f1526f2b51ada3f6b3fbaa2393e"><div class="ttname"><a href="bb__api_8h.html#a80f48f1526f2b51ada3f6b3fbaa2393e">bbConfigureSweepCoupling</a></div><div class="ttdeci">BB_API bbStatus bbConfigureSweepCoupling(int device, double rbw, double vbw, double sweepTime, uint32_t rbwShape, uint32_t rejection)</div></div>
<div class="ttc" id="abb__api_8h_html_a82beee523def2bd762445a4495cd5373"><div class="ttname"><a href="bb__api_8h.html#a82beee523def2bd762445a4495cd5373">bbConfigureCenterSpan</a></div><div class="ttdeci">BB_API bbStatus bbConfigureCenterSpan(int device, double center, double span)</div></div>
<div class="ttc" id="abb__api_8h_html_a903a925cc8d037cb82422bb47a9b3872"><div class="ttname"><a href="bb__api_8h.html#a903a925cc8d037cb82422bb47a9b3872">BB_POWER</a></div><div class="ttdeci">#define BB_POWER</div><div class="ttdef"><b>Definition:</b> bb_api.h:171</div></div>
<div class="ttc" id="abb__api_8h_html_a94837e7f5ac6882499f46db29bbc0427"><div class="ttname"><a href="bb__api_8h.html#a94837e7f5ac6882499f46db29bbc0427">bbInitiate</a></div><div class="ttdeci">BB_API bbStatus bbInitiate(int device, uint32_t mode, uint32_t flag)</div></div>
<div class="ttc" id="abb__api_8h_html_aad4b52476a49e0f2e8134f320d79b1a8"><div class="ttname"><a href="bb__api_8h.html#aad4b52476a49e0f2e8134f320d79b1a8">BB_SWEEPING</a></div><div class="ttdeci">#define BB_SWEEPING</div><div class="ttdef"><b>Definition:</b> bb_api.h:130</div></div>
<div class="ttc" id="abb__api_8h_html_ab8b68101c30b2c38dd455fa7cfc90a2c"><div class="ttname"><a href="bb__api_8h.html#ab8b68101c30b2c38dd455fa7cfc90a2c">bbGetErrorString</a></div><div class="ttdeci">BB_API const char * bbGetErrorString(bbStatus status)</div></div>
<div class="ttc" id="abb__api_8h_html_ab92ec1dec31d08f9a77d6ab057f4dd07"><div class="ttname"><a href="bb__api_8h.html#ab92ec1dec31d08f9a77d6ab057f4dd07">bbOpenDevice</a></div><div class="ttdeci">BB_API bbStatus bbOpenDevice(int *device)</div></div>
<div class="ttc" id="abb__api_8h_html_abc8751772e5c7903c5b223fa8a239fca"><div class="ttname"><a href="bb__api_8h.html#abc8751772e5c7903c5b223fa8a239fca">bbStatus</a></div><div class="ttdeci">bbStatus</div><div class="ttdef"><b>Definition:</b> bb_api.h:344</div></div>
<div class="ttc" id="abb__api_8h_html_abc8751772e5c7903c5b223fa8a239fcaa3c1a69b8400242534b2b1b07d08bfa16"><div class="ttname"><a href="bb__api_8h.html#abc8751772e5c7903c5b223fa8a239fcaa3c1a69b8400242534b2b1b07d08bfa16">bbNoError</a></div><div class="ttdeci">@ bbNoError</div><div class="ttdef"><b>Definition:</b> bb_api.h:423</div></div>
<div class="ttc" id="abb__api_8h_html_ac19bb704f9607149f4a8cb9d725f5d1c"><div class="ttname"><a href="bb__api_8h.html#ac19bb704f9607149f4a8cb9d725f5d1c">bbCloseDevice</a></div><div class="ttdeci">BB_API bbStatus bbCloseDevice(int device)</div></div>
<div class="ttc" id="abb__api_8h_html_aef095decdcc0c3d5d8cb8c0e962dafae"><div class="ttname"><a href="bb__api_8h.html#aef095decdcc0c3d5d8cb8c0e962dafae">bbConfigureRefLevel</a></div><div class="ttdeci">BB_API bbStatus bbConfigureRefLevel(int device, double refLevel)</div></div>
<div class="ttc" id="abb__api_8h_html_af50673d6cd1415224bb3200602f0cb56"><div class="ttname"><a href="bb__api_8h.html#af50673d6cd1415224bb3200602f0cb56">bbFetchTrace_32f</a></div><div class="ttdeci">BB_API bbStatus bbFetchTrace_32f(int device, int arraySize, float *traceMin, float *traceMax)</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md37"></a>
Configuration</h2>
<p >The configuration routines which affect the sweep results are:</p><ul>
<li><a class="el" href="bb__api_8h.html#a82beee523def2bd762445a4495cd5373">bbConfigureCenterSpan</a></li>
<li><a class="el" href="bb__api_8h.html#aef095decdcc0c3d5d8cb8c0e962dafae">bbConfigureRefLevel</a></li>
<li><a class="el" href="bb__api_8h.html#a80f48f1526f2b51ada3f6b3fbaa2393e">bbConfigureSweepCoupling</a></li>
<li><a class="el" href="bb__api_8h.html#a6ecdc66c72d6384b465b5bcaf6f4cd98">bbConfigureAcquisition</a></li>
<li><a class="el" href="bb__api_8h.html#a6576bc394c4a1c831231f14dd4b82490">bbConfigureProcUnits</a></li>
</ul>
<p >Once you have configured the device, you will initialize the device using the <a class="el" href="bb__api_8h.html#aad4b52476a49e0f2e8134f320d79b1a8">BB_SWEEPING</a> flag.</p>
<h2><a class="anchor" id="autotoc_md38"></a>
Usage</h2>
<p >This mode is driven by the programmer, causing a sweep to be collected only when the program requests one through the <a class="el" href="bb__api_8h.html#a492c3115f997be85c305a5db9bbff12a">bbFetchTrace</a> functions. The length of the sweep is determined by a combination of resolution bandwidth, video bandwidth and sweep time.</p>
<p >Once the device is initialized you can determine the characteristics of the sweep you will be collecting with <a class="el" href="bb__api_8h.html#a71b1e19fca5baaed630eaf31ab9055cd">bbQueryTraceInfo</a>. This function returns the length of the sweep, the frequency of the first bin, and the bin size (difference in frequency between any two samples). You will then need to allocate memory for the sweep.</p>
<p >Now you can call <a class="el" href="bb__api_8h.html#a492c3115f997be85c305a5db9bbff12a">bbFetchTrace</a>. This is a blocking call that does not begin the sweep until the function is called.</p>
<p >Determining the frequency of any point returned is determined by the function below, where ‘n’ starts at zero for the first sample point.</p>
<p ><code>Frequency of nth sample point in returned sweep = startFreq + n * binSize</code></p>
<h1><a class="anchor" id="realTimeAnalysis"></a>
Real-Time Spectrum Analysis</h1>
<p >The API provides the functionality of a real-time spectrum analyzer for the full instantaneous bandwidth of the device (20MHz for the BB60A, 27MHz for the BB60C and BB60D). Using FFTs at an overlapping rate of 50%, the spectrum results have no blind time (100% probability of intercept) for events as short as 4.8us at full amplitude (at 631kHz RBW). The RBW shape is restricted to the Nuttall window, and VBW is not configurable.</p>
<h2><a class="anchor" id="autotoc_md39"></a>
Example</h2>
<p >For a list of all examples, please see the <em>examples/</em> folder in the SDK.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="bb__api_8h.html">bb_api.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><span class="preprocessor">#pragma comment(lib, &quot;bb_api.lib&quot;</span>)</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">This example illustrates how to perform real-time spectrum analysis</span></div>
<div class="line"><span class="comment">with the API. The sweep and and persistence frames are retrieved.</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> bbExampleRealTime()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> handle;</div>
<div class="line">    <a class="code hl_enumeration" href="bb__api_8h.html#abc8751772e5c7903c5b223fa8a239fca">bbStatus</a> status = <a class="code hl_function" href="bb__api_8h.html#ab92ec1dec31d08f9a77d6ab057f4dd07">bbOpenDevice</a>(&amp;handle);</div>
<div class="line">    <span class="keywordflow">if</span>(status != <a class="code hl_enumvalue" href="bb__api_8h.html#abc8751772e5c7903c5b223fa8a239fcaa3c1a69b8400242534b2b1b07d08bfa16">bbNoError</a>) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Issue opening device\n&quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <a class="code hl_function" href="bb__api_8h.html#ab8b68101c30b2c38dd455fa7cfc90a2c">bbGetErrorString</a>(status) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Configure a 27MHz real-time stream at a 2.44GHz center</span></div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#aef095decdcc0c3d5d8cb8c0e962dafae">bbConfigureRefLevel</a>(handle, -20.0);</div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a82beee523def2bd762445a4495cd5373">bbConfigureCenterSpan</a>(handle, 2.44e9, 20.0e6);</div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a80f48f1526f2b51ada3f6b3fbaa2393e">bbConfigureSweepCoupling</a>(handle, 10.e3, 10.0e3, 0.001, </div>
<div class="line">        <a class="code hl_define" href="bb__api_8h.html#a2c2151d19b38182ac796643655119b99">BB_RBW_SHAPE_NUTTALL</a>, <a class="code hl_define" href="bb__api_8h.html#a242c2ee31b8fe7b53d5a74a231bba8de">BB_NO_SPUR_REJECT</a>);</div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a6ecdc66c72d6384b465b5bcaf6f4cd98">bbConfigureAcquisition</a>(handle, <a class="code hl_define" href="bb__api_8h.html#a94621da71b8a4a6b92a6d65b7c5d6ca6">BB_MIN_AND_MAX</a>, <a class="code hl_define" href="bb__api_8h.html#a5026e49fcacdadadb54742865e945d64">BB_LOG_SCALE</a>);</div>
<div class="line">    <span class="comment">// Configure a frame rate of 30fps and 100dB scale for the frame</span></div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#afd3f65f143cfd7f4d0fd8b0c2e630f4e">bbConfigureRealTime</a>(handle, 100.0, 30);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Configuration complete, initialize the device</span></div>
<div class="line">    status = <a class="code hl_function" href="bb__api_8h.html#a94837e7f5ac6882499f46db29bbc0427">bbInitiate</a>(handle, <a class="code hl_define" href="bb__api_8h.html#a91ec5d6dfba31f9b06a01fb61b2cf1ea">BB_REAL_TIME</a>, 0);</div>
<div class="line">    <span class="keywordflow">if</span>(status &lt; <a class="code hl_enumvalue" href="bb__api_8h.html#abc8751772e5c7903c5b223fa8a239fcaa3c1a69b8400242534b2b1b07d08bfa16">bbNoError</a>) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Error configuring device\n&quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <a class="code hl_function" href="bb__api_8h.html#ab8b68101c30b2c38dd455fa7cfc90a2c">bbGetErrorString</a>(status);</div>
<div class="line">        exit(-1);</div>
<div class="line">    } </div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get sweep characteristics and allocate memory for sweep and</span></div>
<div class="line">    <span class="comment">// real-time frames.</span></div>
<div class="line">    uint32_t sweepSize;</div>
<div class="line">    <span class="keywordtype">double</span> binSize, startFreq;</div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a71b1e19fca5baaed630eaf31ab9055cd">bbQueryTraceInfo</a>(handle, &amp;sweepSize, &amp;binSize, &amp;startFreq);</div>
<div class="line">    <span class="keywordtype">int</span> frameWidth, frameHeight;</div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#ae01729b8fa23fc2aa4060f5cba1bc157">bbQueryRealTimeInfo</a>(handle, &amp;frameWidth, &amp;frameHeight);</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;float&gt; sweep(sweepSize);</div>
<div class="line">    std::vector&lt;float&gt; frame(frameWidth * frameHeight);</div>
<div class="line">    std::vector&lt;float&gt; alphaFrame(frameWidth * frameHeight);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Retrieve roughly 1 second worth of real-time persistence frames and sweeps.</span></div>
<div class="line">    <span class="comment">// Ignore min sweep, pass NULL as parameter.</span></div>
<div class="line">    <span class="keywordtype">int</span> frameCount = 0;</div>
<div class="line">    <span class="keywordflow">while</span>(frameCount++ &lt; 30) {</div>
<div class="line">        <a class="code hl_function" href="bb__api_8h.html#acd3843beb3cc362ce29c3b88c148d0d6">bbFetchRealTimeFrame</a>(handle, <span class="keyword">nullptr</span>, sweep.data(), frame.data(), alphaFrame.data());</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Finished/close device</span></div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a6dc895bf3e792c37ee5dbddf37166bb5">bbAbort</a>(handle);</div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#ac19bb704f9607149f4a8cb9d725f5d1c">bbCloseDevice</a>(handle);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="ttc" id="abb__api_8h_html_a2c2151d19b38182ac796643655119b99"><div class="ttname"><a href="bb__api_8h.html#a2c2151d19b38182ac796643655119b99">BB_RBW_SHAPE_NUTTALL</a></div><div class="ttdeci">#define BB_RBW_SHAPE_NUTTALL</div><div class="ttdef"><b>Definition:</b> bb_api.h:155</div></div>
<div class="ttc" id="abb__api_8h_html_a91ec5d6dfba31f9b06a01fb61b2cf1ea"><div class="ttname"><a href="bb__api_8h.html#a91ec5d6dfba31f9b06a01fb61b2cf1ea">BB_REAL_TIME</a></div><div class="ttdeci">#define BB_REAL_TIME</div><div class="ttdef"><b>Definition:</b> bb_api.h:132</div></div>
<div class="ttc" id="abb__api_8h_html_a94621da71b8a4a6b92a6d65b7c5d6ca6"><div class="ttname"><a href="bb__api_8h.html#a94621da71b8a4a6b92a6d65b7c5d6ca6">BB_MIN_AND_MAX</a></div><div class="ttdeci">#define BB_MIN_AND_MAX</div><div class="ttdef"><b>Definition:</b> bb_api.h:162</div></div>
<div class="ttc" id="abb__api_8h_html_acd3843beb3cc362ce29c3b88c148d0d6"><div class="ttname"><a href="bb__api_8h.html#acd3843beb3cc362ce29c3b88c148d0d6">bbFetchRealTimeFrame</a></div><div class="ttdeci">BB_API bbStatus bbFetchRealTimeFrame(int device, float *traceMin, float *traceMax, float *frame, float *alphaFrame)</div></div>
<div class="ttc" id="abb__api_8h_html_ae01729b8fa23fc2aa4060f5cba1bc157"><div class="ttname"><a href="bb__api_8h.html#ae01729b8fa23fc2aa4060f5cba1bc157">bbQueryRealTimeInfo</a></div><div class="ttdeci">BB_API bbStatus bbQueryRealTimeInfo(int device, int *frameWidth, int *frameHeight)</div></div>
<div class="ttc" id="abb__api_8h_html_afd3f65f143cfd7f4d0fd8b0c2e630f4e"><div class="ttname"><a href="bb__api_8h.html#afd3f65f143cfd7f4d0fd8b0c2e630f4e">bbConfigureRealTime</a></div><div class="ttdeci">BB_API bbStatus bbConfigureRealTime(int device, double frameScale, int frameRate)</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md40"></a>
Configuration</h2>
<p >The configuration routines which affect the spectrum results are:</p><ul>
<li><a class="el" href="bb__api_8h.html#afd3f65f143cfd7f4d0fd8b0c2e630f4e">bbConfigureRealTime</a></li>
<li><a class="el" href="bb__api_8h.html#aa3c2175a7cf7b04ecb473f6157f7f2d7">bbConfigureRealTimeOverlap</a></li>
<li><a class="el" href="bb__api_8h.html#a82beee523def2bd762445a4495cd5373">bbConfigureCenterSpan</a></li>
<li><a class="el" href="bb__api_8h.html#aef095decdcc0c3d5d8cb8c0e962dafae">bbConfigureRefLevel</a></li>
<li><a class="el" href="bb__api_8h.html#a6ecdc66c72d6384b465b5bcaf6f4cd98">bbConfigureAcquisition</a></li>
<li><a class="el" href="bb__api_8h.html#a80f48f1526f2b51ada3f6b3fbaa2393e">bbConfigureSweepCoupling</a></li>
</ul>
<p >Once you have configured the device, you will initialize the device using the <a class="el" href="bb__api_8h.html#a91ec5d6dfba31f9b06a01fb61b2cf1ea">BB_REAL_TIME</a> flag.</p>
<h2><a class="anchor" id="autotoc_md41"></a>
Usage</h2>
<p >The number of sweep results far exceeds a program’s capability to acquire, view, and process, therefore the API combines sweeps results for a user specified amount of time. It does this in two ways. One, is the API either max holds or averages the sweep results into a standard sweep.</p>
<p >Also, the API creates an image frame which acts as a density map for every sweep result processed during a period. Both the sweep and density map are returned at rate specified by the function <a class="el" href="bb__api_8h.html#afd3f65f143cfd7f4d0fd8b0c2e630f4e">bbConfigureRealTime</a>.</p>
<p >An alpha frame is also provided by the API. The alphaFrame is the same size as the frame and each index correlates to the same index in the frame. The alphaFrame values represent activity in the frame. When activity occurs in the frame, the index correlating to that activity is set to 1. As time passes and no further activity occurs in that bin, the alphaFrame exponentially decays from 1 to 0. The alpha frame is useful to determine how recent the activity in the frame is and useful for plotting the frames.</p>
<h1><a class="anchor" id="IQStreaming"></a>
I/Q Streaming</h1>
<p >The API can be used to stream I/Q data up to 40 MS/s. I/Q data can be retrieved as 32-bit complex floats or 16-bit complex shorts. I/Q data provided as 32-bit floats are corrected for IF flatness and RF leveling. I/Q data returned as 16-bit shorts is provided as full scale, only correcting for IF flatness and the user must apply a correction value to recover the fully amplitude corrected I/Q data.</p>
<h2><a class="anchor" id="autotoc_md42"></a>
Example</h2>
<p >For a list of all examples, please see the <em>examples/</em> folder in the SDK.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="bb__api_8h.html">bb_api.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><span class="preprocessor">#pragma comment(lib, &quot;bb_api.lib&quot;</span>)</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">This example demonstrates how to configure, initialize, and retrieve data</span></div>
<div class="line"><span class="comment">in I/Q streaming mode. I/Q streaming mode provides continuous I/Q data</span></div>
<div class="line"><span class="comment">at a fixed center frequency with a selectable sample rate.</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> bbExampleIQStreaming()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Connect device</span></div>
<div class="line">    <span class="keywordtype">int</span> handle;</div>
<div class="line">    <a class="code hl_enumeration" href="bb__api_8h.html#abc8751772e5c7903c5b223fa8a239fca">bbStatus</a> status = <a class="code hl_function" href="bb__api_8h.html#ab92ec1dec31d08f9a77d6ab057f4dd07">bbOpenDevice</a>(&amp;handle);</div>
<div class="line">    <span class="keywordflow">if</span>(status != <a class="code hl_enumvalue" href="bb__api_8h.html#abc8751772e5c7903c5b223fa8a239fcaa3c1a69b8400242534b2b1b07d08bfa16">bbNoError</a>) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Issue opening device\n&quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <a class="code hl_function" href="bb__api_8h.html#ab8b68101c30b2c38dd455fa7cfc90a2c">bbGetErrorString</a>(status) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Configure the measurement parameters</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Specify 32-bit floating point complex values</span></div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#ac22dfa48e694a5335bcf1e6ceda8c69d">bbConfigureIQDataType</a>(handle, <a class="code hl_enumvalue" href="bb__api_8h.html#a0c3ed5f5a9ed3077e44cf98e2054dc87a5d91f78baf11e55a20d1147389ac208d">bbDataType32fc</a>);</div>
<div class="line">    <span class="comment">// Set center frequency</span></div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a6a5074038d86f37ac2b9857ab41ee938">bbConfigureIQCenter</a>(handle, 1.0e9);</div>
<div class="line">    <span class="comment">// Set reference level, maximum expected input amplitude</span></div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#aef095decdcc0c3d5d8cb8c0e962dafae">bbConfigureRefLevel</a>(handle, -20.0);</div>
<div class="line">    <span class="comment">// Set a sample rate of 40MS/s and a bandwidth of 27MHz</span></div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a4752688b429809ea2547f5debaf377eb">bbConfigureIQ</a>(handle, 1, 27.0e6);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Initiate the device, once this function returns the device</span></div>
<div class="line">    <span class="comment">// will be streaming I/Q.</span></div>
<div class="line">    status = <a class="code hl_function" href="bb__api_8h.html#a94837e7f5ac6882499f46db29bbc0427">bbInitiate</a>(handle, <a class="code hl_define" href="bb__api_8h.html#aa57c25b4199c6f1b90f90094d5cad246">BB_STREAMING</a>, <a class="code hl_define" href="bb__api_8h.html#a2b6ebbdfb9ea4bea58795b63bbdec13c">BB_STREAM_IQ</a>);</div>
<div class="line">    <span class="keywordflow">if</span>(status != <a class="code hl_enumvalue" href="bb__api_8h.html#abc8751772e5c7903c5b223fa8a239fcaa3c1a69b8400242534b2b1b07d08bfa16">bbNoError</a>) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Initiate error\n&quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <a class="code hl_function" href="bb__api_8h.html#ab8b68101c30b2c38dd455fa7cfc90a2c">bbGetErrorString</a>(status) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <a class="code hl_function" href="bb__api_8h.html#ac19bb704f9607149f4a8cb9d725f5d1c">bbCloseDevice</a>(handle);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get I/Q stream characteristics</span></div>
<div class="line">    <span class="keywordtype">double</span> sampleRate, bandwidth;</div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#ac432defe33151bd061c8accd3a008d4e">bbQueryIQParameters</a>(handle, &amp;sampleRate, &amp;bandwidth);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Allocate memory for BLOCK_SIZE number of complex values</span></div>
<div class="line">    <span class="comment">// This is the number of I/Q samples we will request each function call.</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> BLOCK_SIZE = 262144;</div>
<div class="line">    std::vector&lt;float&gt; buffer(BLOCK_SIZE * 2);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Perform the capture, pass NULL for any parameters we don&#39;t care about</span></div>
<div class="line">    status = <a class="code hl_function" href="bb__api_8h.html#aae19546159522c48c25d95cf01c024cf">bbGetIQUnpacked</a>(handle, buffer.data(), BLOCK_SIZE, 0, 0, </div>
<div class="line">        <a class="code hl_define" href="bb__api_8h.html#a37e1b9babf8ac5e627a8ee53d5d87499">BB_FALSE</a>, 0, 0, 0, 0);</div>
<div class="line">    <span class="comment">// Check status here</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// At this point, BLOCK_SIZE IQ data samples have been retrieved and</span></div>
<div class="line">    <span class="comment">//   stored in the buffer array. Any processing on the data should happen here.</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Continue to call bbGetIQ with the purge flag set to false, which ensures</span></div>
<div class="line">    <span class="comment">//   I/Q data is continuous from the last call.</span></div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; 10; i++) {</div>
<div class="line">        status = <a class="code hl_function" href="bb__api_8h.html#aae19546159522c48c25d95cf01c024cf">bbGetIQUnpacked</a>(handle, buffer.data(), BLOCK_SIZE, 0, 0, </div>
<div class="line">            <a class="code hl_define" href="bb__api_8h.html#a37e1b9babf8ac5e627a8ee53d5d87499">BB_FALSE</a>, 0, 0, 0, 0);</div>
<div class="line">        <span class="comment">// Check status here</span></div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Do processing</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// When done, stop streaming and close device.</span></div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a6dc895bf3e792c37ee5dbddf37166bb5">bbAbort</a>(handle);</div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#ac19bb704f9607149f4a8cb9d725f5d1c">bbCloseDevice</a>(handle);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="ttc" id="abb__api_8h_html_a0c3ed5f5a9ed3077e44cf98e2054dc87a5d91f78baf11e55a20d1147389ac208d"><div class="ttname"><a href="bb__api_8h.html#a0c3ed5f5a9ed3077e44cf98e2054dc87a5d91f78baf11e55a20d1147389ac208d">bbDataType32fc</a></div><div class="ttdeci">@ bbDataType32fc</div><div class="ttdef"><b>Definition:</b> bb_api.h:452</div></div>
<div class="ttc" id="abb__api_8h_html_a2b6ebbdfb9ea4bea58795b63bbdec13c"><div class="ttname"><a href="bb__api_8h.html#a2b6ebbdfb9ea4bea58795b63bbdec13c">BB_STREAM_IQ</a></div><div class="ttdeci">#define BB_STREAM_IQ</div><div class="ttdef"><b>Definition:</b> bb_api.h:187</div></div>
<div class="ttc" id="abb__api_8h_html_a37e1b9babf8ac5e627a8ee53d5d87499"><div class="ttname"><a href="bb__api_8h.html#a37e1b9babf8ac5e627a8ee53d5d87499">BB_FALSE</a></div><div class="ttdeci">#define BB_FALSE</div><div class="ttdef"><b>Definition:</b> bb_api.h:53</div></div>
<div class="ttc" id="abb__api_8h_html_a4752688b429809ea2547f5debaf377eb"><div class="ttname"><a href="bb__api_8h.html#a4752688b429809ea2547f5debaf377eb">bbConfigureIQ</a></div><div class="ttdeci">BB_API bbStatus bbConfigureIQ(int device, int downsampleFactor, double bandwidth)</div></div>
<div class="ttc" id="abb__api_8h_html_a6a5074038d86f37ac2b9857ab41ee938"><div class="ttname"><a href="bb__api_8h.html#a6a5074038d86f37ac2b9857ab41ee938">bbConfigureIQCenter</a></div><div class="ttdeci">BB_API bbStatus bbConfigureIQCenter(int device, double centerFreq)</div></div>
<div class="ttc" id="abb__api_8h_html_aa57c25b4199c6f1b90f90094d5cad246"><div class="ttname"><a href="bb__api_8h.html#aa57c25b4199c6f1b90f90094d5cad246">BB_STREAMING</a></div><div class="ttdeci">#define BB_STREAMING</div><div class="ttdef"><b>Definition:</b> bb_api.h:134</div></div>
<div class="ttc" id="abb__api_8h_html_aae19546159522c48c25d95cf01c024cf"><div class="ttname"><a href="bb__api_8h.html#aae19546159522c48c25d95cf01c024cf">bbGetIQUnpacked</a></div><div class="ttdeci">BB_API bbStatus bbGetIQUnpacked(int device, void *iqData, int iqCount, int *triggers, int triggerCount, int purge, int *dataRemaining, int *sampleLoss, int *sec, int *nano)</div></div>
<div class="ttc" id="abb__api_8h_html_ac22dfa48e694a5335bcf1e6ceda8c69d"><div class="ttname"><a href="bb__api_8h.html#ac22dfa48e694a5335bcf1e6ceda8c69d">bbConfigureIQDataType</a></div><div class="ttdeci">BB_API bbStatus bbConfigureIQDataType(int device, bbDataType dataType)</div></div>
<div class="ttc" id="abb__api_8h_html_ac432defe33151bd061c8accd3a008d4e"><div class="ttname"><a href="bb__api_8h.html#ac432defe33151bd061c8accd3a008d4e">bbQueryIQParameters</a></div><div class="ttdeci">BB_API bbStatus bbQueryIQParameters(int device, double *sampleRate, double *bandwidth)</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md43"></a>
Configuration</h2>
<p >See the following functions for configuring and retrieving I/Q data:</p><ul>
<li><a class="el" href="bb__api_8h.html#a6a5074038d86f37ac2b9857ab41ee938">bbConfigureIQCenter</a></li>
<li><a class="el" href="bb__api_8h.html#aef095decdcc0c3d5d8cb8c0e962dafae">bbConfigureRefLevel</a></li>
<li><a class="el" href="bb__api_8h.html#abaf1a8ac8259ff021c0d34d0f11f5d0d">bbConfigureIO</a> – Used for external triggering.</li>
<li><a class="el" href="bb__api_8h.html#a4752688b429809ea2547f5debaf377eb">bbConfigureIQ</a></li>
<li><a class="el" href="bb__api_8h.html#ac22dfa48e694a5335bcf1e6ceda8c69d">bbConfigureIQDataType</a></li>
<li><a class="el" href="bb__api_8h.html#a00e91af9b54f48a95bb59a5e3c489922">bbConfigureIQTriggerSentinel</a></li>
<li><a class="el" href="bb__api_8h.html#ac432defe33151bd061c8accd3a008d4e">bbQueryIQParameters</a></li>
<li><a class="el" href="bb__api_8h.html#a67aa30099c50ebf1896a44b181b11dcc">bbGetIQCorrection</a></li>
<li><a class="el" href="bb__api_8h.html#aad55bfbe52c9620a1551807127d19065">bbGetIQ</a>/<a class="el" href="bb__api_8h.html#aae19546159522c48c25d95cf01c024cf">bbGetIQUnpacked</a></li>
</ul>
<p >Once configured, initialize the device with the <a class="el" href="bb__api_8h.html#aa57c25b4199c6f1b90f90094d5cad246">BB_STREAMING</a> flag.</p>
<h2><a class="anchor" id="autotoc_md44"></a>
Usage</h2>
<p >The I/Q data can be decimated by powers of 2 up to a decimation of 8192. The API provides users a customizable bandpass filter cutoff frequency at any sample rate.</p>
<p >The I/Q data stream can be tuned to any frequency within the BB60 frequency range.</p>
<p >Data acquisition begins immediately. The API buffers ~3/4 second worth of I/Q samples in a circular buffer. Samples can be retrieved with the <a class="el" href="bb__api_8h.html#aad55bfbe52c9620a1551807127d19065">bbGetIQ</a> function. If you wish to retrieve all samples, it is the responsibility of the user’s application to poll the samples fast enough to prevent the APIs internal buffers from accumulating too much I/Q data. We suggest a separate polling thread and synchronized data structure (buffer) for retrieving the samples and using them in your application.</p>
<p >NOTE: Decimation and filtering occur on the PC and can be processor intensive on certain hardware. Please characterize the processor load.</p>
<h2><a class="anchor" id="autotoc_md45"></a>
External Triggering</h2>
<p >External trigger information can be retrieved when I/Q streaming. Trigger information is provided through the triggers buffer in the <a class="el" href="bb__api_8h.html#aad55bfbe52c9620a1551807127d19065">bbGetIQ</a> function.</p>
<h3><a class="anchor" id="autotoc_md46"></a>
Example</h3>
<p >For a list of all examples, please see the <em>examples/</em> folder in the SDK.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="bb__api_8h.html">bb_api.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;complex&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><span class="preprocessor">#pragma comment(lib, &quot;bb_api.lib&quot;</span>)</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">This example demonstrates using the BB60 to look for an external trigger.</span></div>
<div class="line"><span class="comment">This example waits for an external trigger, and captures N I/Q samples after</span></div>
<div class="line"><span class="comment">  that trigger. If no trigger arrives this example will loop indefinitely.</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> TRIGGER_SENTINEL = -1;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> bbExampleIQExtTrigger()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> handle;</div>
<div class="line">    <a class="code hl_enumeration" href="bb__api_8h.html#abc8751772e5c7903c5b223fa8a239fca">bbStatus</a> status = <a class="code hl_function" href="bb__api_8h.html#ab92ec1dec31d08f9a77d6ab057f4dd07">bbOpenDevice</a>(&amp;handle);</div>
<div class="line">    <span class="keywordflow">if</span>(status != <a class="code hl_enumvalue" href="bb__api_8h.html#abc8751772e5c7903c5b223fa8a239fcaa3c1a69b8400242534b2b1b07d08bfa16">bbNoError</a>) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Issue opening device\n&quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <a class="code hl_function" href="bb__api_8h.html#ab8b68101c30b2c38dd455fa7cfc90a2c">bbGetErrorString</a>(status) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> deviceType;</div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#aeccd694c454b674f244b3390d433edb0">bbGetDeviceType</a>(handle, &amp;deviceType);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Configure BNC port 2 for rising edge trigger detection</span></div>
<div class="line">    <span class="keywordflow">if</span>(deviceType == <a class="code hl_define" href="bb__api_8h.html#a12d17233bfd2ba09e3354fc70f0a623d">BB_DEVICE_BB60D</a>) {</div>
<div class="line">        <span class="comment">// BB60D</span></div>
<div class="line">        <a class="code hl_function" href="bb__api_8h.html#abaf1a8ac8259ff021c0d34d0f11f5d0d">bbConfigureIO</a>(handle, <a class="code hl_define" href="bb__api_8h.html#ae2e7de7d62fb603ba426aa7a1882dc52">BB60D_PORT1_DISABLED</a>, <a class="code hl_define" href="bb__api_8h.html#acdc3711b210bae68f9cc57d12893d737">BB60D_PORT2_IN_TRIG_RISING_EDGE</a>);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="comment">// BB60C/A devices</span></div>
<div class="line">        <a class="code hl_function" href="bb__api_8h.html#abaf1a8ac8259ff021c0d34d0f11f5d0d">bbConfigureIO</a>(handle, 0, <a class="code hl_define" href="bb__api_8h.html#a69b4897f71b11f570dfb5efb9e87aee0">BB60C_PORT2_IN_TRIG_RISING_EDGE</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Now configure the measurement parameters</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// We want 32-bit floating point complex values</span></div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#ac22dfa48e694a5335bcf1e6ceda8c69d">bbConfigureIQDataType</a>(handle, <a class="code hl_enumvalue" href="bb__api_8h.html#a0c3ed5f5a9ed3077e44cf98e2054dc87a5d91f78baf11e55a20d1147389ac208d">bbDataType32fc</a>);</div>
<div class="line">    <span class="comment">// Set center frequency to 1GHz</span></div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a6a5074038d86f37ac2b9857ab41ee938">bbConfigureIQCenter</a>(handle, 1.0e9);</div>
<div class="line">    <span class="comment">// Set reference level </span></div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#aef095decdcc0c3d5d8cb8c0e962dafae">bbConfigureRefLevel</a>(handle, -20.0);</div>
<div class="line">    <span class="comment">// Set a sample rate of 40.0e6 / 2 = 20.0e6 MS/s and bandwidth of 15 MHz</span></div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a4752688b429809ea2547f5debaf377eb">bbConfigureIQ</a>(handle, 2, 15.0e6);</div>
<div class="line">    <span class="comment">// By default the sentinel is zero, set to -1</span></div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a00e91af9b54f48a95bb59a5e3c489922">bbConfigureIQTriggerSentinel</a>(TRIGGER_SENTINEL);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Initiate the device, once this function returns the device</span></div>
<div class="line">    <span class="comment">// will be streaming I/Q.</span></div>
<div class="line">    status = <a class="code hl_function" href="bb__api_8h.html#a94837e7f5ac6882499f46db29bbc0427">bbInitiate</a>(handle, <a class="code hl_define" href="bb__api_8h.html#aa57c25b4199c6f1b90f90094d5cad246">BB_STREAMING</a>, <a class="code hl_define" href="bb__api_8h.html#a2b6ebbdfb9ea4bea58795b63bbdec13c">BB_STREAM_IQ</a>);</div>
<div class="line">    <span class="keywordflow">if</span>(status != <a class="code hl_enumvalue" href="bb__api_8h.html#abc8751772e5c7903c5b223fa8a239fcaa3c1a69b8400242534b2b1b07d08bfa16">bbNoError</a>) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Initiate error\n&quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <a class="code hl_function" href="bb__api_8h.html#ab8b68101c30b2c38dd455fa7cfc90a2c">bbGetErrorString</a>(status) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <a class="code hl_function" href="bb__api_8h.html#ac19bb704f9607149f4a8cb9d725f5d1c">bbCloseDevice</a>(handle);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get I/Q stream characteristics</span></div>
<div class="line">    <span class="keywordtype">double</span> sampleRate, bandwidth;</div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#ac432defe33151bd061c8accd3a008d4e">bbQueryIQParameters</a>(handle, &amp;sampleRate, &amp;bandwidth);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// This is how much data we want after the external trigger</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> N = 1e6;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// I/Q capture buffer</span></div>
<div class="line">    std::vector&lt;std::complex&lt;float&gt;&gt; buffer(N);</div>
<div class="line">    <span class="comment">// We only care about the first trigger we see. If you need more triggers,</span></div>
<div class="line">    <span class="comment">//   this can be an array.</span></div>
<div class="line">    <span class="keywordtype">int</span> triggerPos = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span>(<span class="keyword">true</span>) {</div>
<div class="line">        <span class="comment">// Perform the capture, pass NULL for any parameters we don&#39;t care about</span></div>
<div class="line">        status = <a class="code hl_function" href="bb__api_8h.html#aae19546159522c48c25d95cf01c024cf">bbGetIQUnpacked</a>(handle, &amp;buffer[0], N, &amp;triggerPos, 1,</div>
<div class="line">            <a class="code hl_define" href="bb__api_8h.html#a37e1b9babf8ac5e627a8ee53d5d87499">BB_FALSE</a>, 0, 0, 0, 0);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// At this point, N I/Q samples have been retrieved and</span></div>
<div class="line">        <span class="comment">//  stored in the buffer array. If any triggers were seen during the capture</span></div>
<div class="line">        <span class="comment">//  of the returned samples, the trigger parameter will contain an index into</span></div>
<div class="line">        <span class="comment">//  the buffer array at which the trigger was seen. </span></div>
<div class="line">        <span class="comment">// A trigger value not equal to the sentinel means a trigger is present</span></div>
<div class="line">        <span class="keywordflow">if</span>(triggerPos != TRIGGER_SENTINEL) {</div>
<div class="line">            <span class="comment">// We have a trigger, now finish capture</span></div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Unless trigger was at beginning, we still need to capture some data</span></div>
<div class="line">    <span class="comment">//  to retrive N samples.</span></div>
<div class="line">    <span class="keywordtype">int</span> samplesAfterTrigger = N - triggerPos;</div>
<div class="line">    <span class="keywordtype">int</span> samplesLeft = N - samplesAfterTrigger;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Move the samples after the trigger to the beginning of the buffer.</span></div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; samplesAfterTrigger; i++) {</div>
<div class="line">        buffer[i] = buffer[i + triggerPos];</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get the rest of the contiguous samples</span></div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#aae19546159522c48c25d95cf01c024cf">bbGetIQUnpacked</a>(handle, &amp;buffer[samplesAfterTrigger], samplesLeft,</div>
<div class="line">        0, 0, <a class="code hl_define" href="bb__api_8h.html#a37e1b9babf8ac5e627a8ee53d5d87499">BB_FALSE</a>, 0, 0, 0, 0);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// When done, stop streaming and close device.</span></div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a6dc895bf3e792c37ee5dbddf37166bb5">bbAbort</a>(handle);</div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#ac19bb704f9607149f4a8cb9d725f5d1c">bbCloseDevice</a>(handle);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="ttc" id="abb__api_8h_html_a00e91af9b54f48a95bb59a5e3c489922"><div class="ttname"><a href="bb__api_8h.html#a00e91af9b54f48a95bb59a5e3c489922">bbConfigureIQTriggerSentinel</a></div><div class="ttdeci">BB_API bbStatus bbConfigureIQTriggerSentinel(int sentinel)</div></div>
<div class="ttc" id="abb__api_8h_html_a12d17233bfd2ba09e3354fc70f0a623d"><div class="ttname"><a href="bb__api_8h.html#a12d17233bfd2ba09e3354fc70f0a623d">BB_DEVICE_BB60D</a></div><div class="ttdeci">#define BB_DEVICE_BB60D</div><div class="ttdef"><b>Definition:</b> bb_api.h:62</div></div>
<div class="ttc" id="abb__api_8h_html_a69b4897f71b11f570dfb5efb9e87aee0"><div class="ttname"><a href="bb__api_8h.html#a69b4897f71b11f570dfb5efb9e87aee0">BB60C_PORT2_IN_TRIG_RISING_EDGE</a></div><div class="ttdeci">#define BB60C_PORT2_IN_TRIG_RISING_EDGE</div><div class="ttdef"><b>Definition:</b> bb_api.h:217</div></div>
<div class="ttc" id="abb__api_8h_html_abaf1a8ac8259ff021c0d34d0f11f5d0d"><div class="ttname"><a href="bb__api_8h.html#abaf1a8ac8259ff021c0d34d0f11f5d0d">bbConfigureIO</a></div><div class="ttdeci">BB_API bbStatus bbConfigureIO(int device, uint32_t port1, uint32_t port2)</div></div>
<div class="ttc" id="abb__api_8h_html_acdc3711b210bae68f9cc57d12893d737"><div class="ttname"><a href="bb__api_8h.html#acdc3711b210bae68f9cc57d12893d737">BB60D_PORT2_IN_TRIG_RISING_EDGE</a></div><div class="ttdeci">#define BB60D_PORT2_IN_TRIG_RISING_EDGE</div><div class="ttdef"><b>Definition:</b> bb_api.h:232</div></div>
<div class="ttc" id="abb__api_8h_html_ae2e7de7d62fb603ba426aa7a1882dc52"><div class="ttname"><a href="bb__api_8h.html#ae2e7de7d62fb603ba426aa7a1882dc52">BB60D_PORT1_DISABLED</a></div><div class="ttdeci">#define BB60D_PORT1_DISABLED</div><div class="ttdef"><b>Definition:</b> bb_api.h:223</div></div>
<div class="ttc" id="abb__api_8h_html_aeccd694c454b674f244b3390d433edb0"><div class="ttname"><a href="bb__api_8h.html#aeccd694c454b674f244b3390d433edb0">bbGetDeviceType</a></div><div class="ttdeci">BB_API bbStatus bbGetDeviceType(int device, int *deviceType)</div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md47"></a>
Usage</h3>
<p >If a trigger buffer is provided to <a class="el" href="bb__api_8h.html#aad55bfbe52c9620a1551807127d19065">bbGetIQ</a>, any external trigger events seen during the acquisition of the returned I/Q data will be placed in the trigger buffer. External trigger events are returned as indices into the I/Q data at which the trigger event occurred. For example, if 1000 I/Q samples are requested and a trigger buffer of size 3 is provided, and the function returns with the trigger buffer set to [12,300,876], this indicates that an external trigger event occurred at I/Q sample index 12, 300, and 876 in the I/Q data returned from this function call.</p>
<p >If fewer external triggers were seen during the I/Q acquisition than the size of the trigger buffer provided, the remainder of the trigger buffer is set to the sentinel value. The default sentinel value is 0, so for example, if a trigger buffer of size 3 is provided, and only a single trigger event was seen, the trigger buffer will return [N, 0, 0] where N is the single trigger index returned.</p>
<p >If more trigger events were seen during the I/Q acquisition than the size of the trigger buffer, those trigger events that cannot fit in the buffer are discarded.</p>
<p >A note on trigger sentinel values: the default sentinel value of 0 does not allow the detection of triggers occurring at the first sample point. If this is an issue, set the sentinel value to -1 or some other negative value which cannot be normally returned. The default value of 0 is the result of historical choices and will remain the default value.</p>
<h1><a class="anchor" id="audioDemod"></a>
Audio Demodulation</h1>
<h2><a class="anchor" id="autotoc_md48"></a>
Example</h2>
<p >For a list of all examples, please see the <em>examples/</em> folder in the SDK.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="bb__api_8h.html">bb_api.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><span class="preprocessor">#pragma comment(lib, &quot;bb_api.lib&quot;</span>)</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">This example demonstrates how to configure, initialize, and retrieve data</span></div>
<div class="line"><span class="comment">in audio demodulation mode.</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> bbExampleAudioDemod()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Connect device</span></div>
<div class="line">    <span class="keywordtype">int</span> handle;</div>
<div class="line">    <a class="code hl_enumeration" href="bb__api_8h.html#abc8751772e5c7903c5b223fa8a239fca">bbStatus</a> status = <a class="code hl_function" href="bb__api_8h.html#ab92ec1dec31d08f9a77d6ab057f4dd07">bbOpenDevice</a>(&amp;handle);</div>
<div class="line">    <span class="keywordflow">if</span>(status != <a class="code hl_enumvalue" href="bb__api_8h.html#abc8751772e5c7903c5b223fa8a239fcaa3c1a69b8400242534b2b1b07d08bfa16">bbNoError</a>) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Issue opening device\n&quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <a class="code hl_function" href="bb__api_8h.html#ab8b68101c30b2c38dd455fa7cfc90a2c">bbGetErrorString</a>(status) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Configure the measurement parameters</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Set the demodulation scheme, center frequency, IF bandwidth,</span></div>
<div class="line">    <span class="comment">//   post demodulation low &amp; hi pass filter frequencies, and FM deemphasis in microseconds</span></div>
<div class="line">    status = <a class="code hl_function" href="bb__api_8h.html#abcf4fed1b3d419811e73e07a04409389">bbConfigureDemod</a>(handle, <a class="code hl_define" href="bb__api_8h.html#aee593195fe48017177698a0436b425df">BB_DEMOD_FM</a>, 97.1e6, 120.0e3, 8.0e3, 20.0, 75.0);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Initiate the device, once this function returns the device</span></div>
<div class="line">    <span class="comment">//   will be streaming demodulated audio data.</span></div>
<div class="line">    status = <a class="code hl_function" href="bb__api_8h.html#a94837e7f5ac6882499f46db29bbc0427">bbInitiate</a>(handle, <a class="code hl_define" href="bb__api_8h.html#a885ee753b987863de508e09c45d811ff">BB_AUDIO_DEMOD</a>, 0);</div>
<div class="line">    <span class="keywordflow">if</span>(status != <a class="code hl_enumvalue" href="bb__api_8h.html#abc8751772e5c7903c5b223fa8a239fcaa3c1a69b8400242534b2b1b07d08bfa16">bbNoError</a>) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Initiate error\n&quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <a class="code hl_function" href="bb__api_8h.html#ab8b68101c30b2c38dd455fa7cfc90a2c">bbGetErrorString</a>(status) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <a class="code hl_function" href="bb__api_8h.html#ac19bb704f9607149f4a8cb9d725f5d1c">bbCloseDevice</a>(handle);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Allocate memory for 4096 audio samples for an audio sample rate of 32k.</span></div>
<div class="line">    <span class="comment">// This is the number of audio samples we will acquire each function call.</span></div>
<div class="line">    std::vector&lt;float&gt; buffer(4096);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Perform the capture</span></div>
<div class="line">    status = <a class="code hl_function" href="bb__api_8h.html#ac26134ea4b267242d8900d836fef2692">bbFetchAudio</a>(handle, buffer.data());</div>
<div class="line">    <span class="comment">// Check status here</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// At this point, 4096 audio samples have been retrieved and</span></div>
<div class="line">    <span class="comment">//   stored in the buffer array. Any processing on the data should happen here.</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Continue to call bbFetchAudio.</span></div>
<div class="line">    <span class="comment">// While streaming, it is possible to continue to change the audio settings via </span></div>
<div class="line">    <span class="comment">//  bbConfigureDemod() as long as the updated center frequency is not +/- 8 MHz </span></div>
<div class="line">    <span class="comment">//  of the value specified when bbInitiate() was called.</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; 10; i++) {</div>
<div class="line">        status = <a class="code hl_function" href="bb__api_8h.html#ac26134ea4b267242d8900d836fef2692">bbFetchAudio</a>(handle, buffer.data());</div>
<div class="line">        <span class="comment">// Check status here</span></div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Do processing</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// When done, stop streaming and close device.</span></div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a6dc895bf3e792c37ee5dbddf37166bb5">bbAbort</a>(handle);</div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#ac19bb704f9607149f4a8cb9d725f5d1c">bbCloseDevice</a>(handle);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="ttc" id="abb__api_8h_html_a885ee753b987863de508e09c45d811ff"><div class="ttname"><a href="bb__api_8h.html#a885ee753b987863de508e09c45d811ff">BB_AUDIO_DEMOD</a></div><div class="ttdeci">#define BB_AUDIO_DEMOD</div><div class="ttdef"><b>Definition:</b> bb_api.h:136</div></div>
<div class="ttc" id="abb__api_8h_html_abcf4fed1b3d419811e73e07a04409389"><div class="ttname"><a href="bb__api_8h.html#abcf4fed1b3d419811e73e07a04409389">bbConfigureDemod</a></div><div class="ttdeci">BB_API bbStatus bbConfigureDemod(int device, int modulationType, double freq, float IFBW, float audioLowPassFreq, float audioHighPassFreq, float FMDeemphasis)</div></div>
<div class="ttc" id="abb__api_8h_html_ac26134ea4b267242d8900d836fef2692"><div class="ttname"><a href="bb__api_8h.html#ac26134ea4b267242d8900d836fef2692">bbFetchAudio</a></div><div class="ttdeci">BB_API bbStatus bbFetchAudio(int device, float *audio)</div></div>
<div class="ttc" id="abb__api_8h_html_aee593195fe48017177698a0436b425df"><div class="ttname"><a href="bb__api_8h.html#aee593195fe48017177698a0436b425df">BB_DEMOD_FM</a></div><div class="ttdeci">#define BB_DEMOD_FM</div><div class="ttdef"><b>Definition:</b> bb_api.h:178</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md49"></a>
Configuration</h2>
<p >Initialize the device with the <a class="el" href="bb__api_8h.html#a885ee753b987863de508e09c45d811ff">BB_AUDIO_DEMOD</a> flag.</p>
<h2><a class="anchor" id="autotoc_md50"></a>
Usage</h2>
<p >When audio is being performed, no other measurements can take place. If you need the I/Q data and the ability to demodulate audio, consider using the I/Q streaming functionality and performing the audio demodulation on the I/Q data from there.</p>
<p >Once the device is streaming audio it is possible to continue to change the audio settings via <a class="el" href="bb__api_8h.html#abcf4fed1b3d419811e73e07a04409389">bbConfigureDemod</a> if the updated center frequency does not exceed +/- 8 MHz of the value specified when <a class="el" href="bb__api_8h.html#a94837e7f5ac6882499f46db29bbc0427">bbInitiate</a> was called. The center frequency is specified in <a class="el" href="bb__api_8h.html#abcf4fed1b3d419811e73e07a04409389">bbConfigureDemod</a>.</p>
<p >Once the device is streaming, use <a class="el" href="bb__api_8h.html#ac26134ea4b267242d8900d836fef2692">bbFetchAudio</a> to retrieve 4096 audio samples for an audio sample rate of 32k.</p>
<h1><a class="anchor" id="snaMode"></a>
Scalar Network Analysis</h1>
<p >When a Signal Hound tracking generator is paired together with a BB60D, BB60C, or BB60A spectrum analyzer, the products can function as a scalar network analyzer to perform insertion loss measurements or return loss measurements by adding a directional coupler. Throughout this document, this functionality will be referred to as tracking generator (or TG) sweeps.</p>
<h2><a class="anchor" id="autotoc_md51"></a>
Example</h2>
<p >For a list of all examples, please see the <em>examples/</em> folder in the SDK.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="bb__api_8h.html">bb_api.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><span class="preprocessor">#pragma comment(lib, &quot;bb_api.lib&quot;</span>)</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// This example demonstrates how to use the API to perform a single tracking generator sweep.</span></div>
<div class="line"><span class="comment">// See the manual for a full description of each step of the process in the</span></div>
<div class="line"><span class="comment">// Scalar Network Analysis section.</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> bbExampleScalarNetworkAnalysis()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Connect device</span></div>
<div class="line">    <span class="keywordtype">int</span> handle;</div>
<div class="line">    <a class="code hl_enumeration" href="bb__api_8h.html#abc8751772e5c7903c5b223fa8a239fca">bbStatus</a> status = <a class="code hl_function" href="bb__api_8h.html#ab92ec1dec31d08f9a77d6ab057f4dd07">bbOpenDevice</a>(&amp;handle);</div>
<div class="line">    <span class="keywordflow">if</span>(status != <a class="code hl_enumvalue" href="bb__api_8h.html#abc8751772e5c7903c5b223fa8a239fcaa3c1a69b8400242534b2b1b07d08bfa16">bbNoError</a>) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Issue opening device\n&quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <a class="code hl_function" href="bb__api_8h.html#ab8b68101c30b2c38dd455fa7cfc90a2c">bbGetErrorString</a>(status) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span>(<a class="code hl_function" href="bb__api_8h.html#a2363fd94e54b6561fdb60902c789a49d">bbAttachTg</a>(handle) != <a class="code hl_enumvalue" href="bb__api_8h.html#abc8751772e5c7903c5b223fa8a239fcaa3c1a69b8400242534b2b1b07d08bfa16">bbNoError</a>) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Unable to find tracking generator\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Sweep some device at 900 MHz center with 1 MHz span</span></div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a82beee523def2bd762445a4495cd5373">bbConfigureCenterSpan</a>(handle, 900.0e6, 1.0e6);</div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a6ecdc66c72d6384b465b5bcaf6f4cd98">bbConfigureAcquisition</a>(handle, <a class="code hl_define" href="bb__api_8h.html#a94621da71b8a4a6b92a6d65b7c5d6ca6">BB_MIN_AND_MAX</a>, <a class="code hl_define" href="bb__api_8h.html#a5026e49fcacdadadb54742865e945d64">BB_LOG_SCALE</a>);</div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#aef095decdcc0c3d5d8cb8c0e962dafae">bbConfigureRefLevel</a>(handle, -10.0);</div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a80f48f1526f2b51ada3f6b3fbaa2393e">bbConfigureSweepCoupling</a>(handle, 1.0e3, 1.0e3, 0.001, <a class="code hl_define" href="bb__api_8h.html#a7f2644ea86cca89a2df9de212014906f">BB_RBW_SHAPE_FLATTOP</a>, <a class="code hl_define" href="bb__api_8h.html#adc139b5b443dc6d647e08a2a68155ca4">BB_SPUR_REJECT</a>);</div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a6576bc394c4a1c831231f14dd4b82490">bbConfigureProcUnits</a>(handle, <a class="code hl_define" href="bb__api_8h.html#a903a925cc8d037cb82422bb47a9b3872">BB_POWER</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Additional configuration routine</span></div>
<div class="line">    <span class="comment">// Configure a 100 point sweep</span></div>
<div class="line">    <span class="comment">// The size of the sweep is a suggestion to the API, it will attempt to get near the requested size</span></div>
<div class="line">    <span class="comment">// Optimized for high dynamic range and passive devices</span></div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a71b852dd5871f9f14e290f7c0d2ef9cc">bbConfigTgSweep</a>(handle, 100, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Configuration complete, initialize the device</span></div>
<div class="line">    status = <a class="code hl_function" href="bb__api_8h.html#a94837e7f5ac6882499f46db29bbc0427">bbInitiate</a>(handle, <a class="code hl_define" href="bb__api_8h.html#a70350577bf029b1575273a91a1cb0859">BB_TG_SWEEPING</a>, 0);</div>
<div class="line">    <span class="keywordflow">if</span>(status &lt; <a class="code hl_enumvalue" href="bb__api_8h.html#abc8751772e5c7903c5b223fa8a239fcaa3c1a69b8400242534b2b1b07d08bfa16">bbNoError</a>) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Error configuring device\n&quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <a class="code hl_function" href="bb__api_8h.html#ab8b68101c30b2c38dd455fa7cfc90a2c">bbGetErrorString</a>(status);</div>
<div class="line">        exit(-1);</div>
<div class="line">    } </div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get sweep characteristics and allocate memory for sweep</span></div>
<div class="line">    uint32_t sweepSize;</div>
<div class="line">    <span class="keywordtype">double</span> binSize, startFreq;</div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a71b1e19fca5baaed630eaf31ab9055cd">bbQueryTraceInfo</a>(handle, &amp;sweepSize, &amp;binSize, &amp;startFreq);</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;float&gt; sweep(sweepSize);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create test set-up without DUT present</span></div>
<div class="line">    <span class="comment">// Get one sweep</span></div>
<div class="line">    <span class="comment">// Pass NULL for the min parameter. For most scenarios, the min sweep can be ignored.</span></div>
<div class="line">    status = <a class="code hl_function" href="bb__api_8h.html#af50673d6cd1415224bb3200602f0cb56">bbFetchTrace_32f</a>(handle, sweepSize, 0, sweep.data());</div>
<div class="line">    <span class="keywordflow">if</span>(status != <a class="code hl_enumvalue" href="bb__api_8h.html#abc8751772e5c7903c5b223fa8a239fcaa3c1a69b8400242534b2b1b07d08bfa16">bbNoError</a>) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Sweep status: &quot;</span> &lt;&lt; <a class="code hl_function" href="bb__api_8h.html#ab8b68101c30b2c38dd455fa7cfc90a2c">bbGetErrorString</a>(status) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Store baseline</span></div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a6439afedb8069eb699b1d9bae0ceed84">bbStoreTgThru</a>(handle, <a class="code hl_define" href="bb__api_8h.html#a1d5030d8a63472fecee13a624c3f17ea">TG_THRU_0DB</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Should pause here, and insert DUT into test set-up</span></div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#af50673d6cd1415224bb3200602f0cb56">bbFetchTrace_32f</a>(handle, sweepSize, 0, sweep.data());</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// From here, you can sweep several times without needing to restore the thru.</span></div>
<div class="line">    <span class="comment">// Once you change your setup, you should reconfigure the device and </span></div>
<div class="line">    <span class="comment">//   store the thru again without the DUT inline.</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Finished/close device</span></div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#a6dc895bf3e792c37ee5dbddf37166bb5">bbAbort</a>(handle);</div>
<div class="line">    <a class="code hl_function" href="bb__api_8h.html#ac19bb704f9607149f4a8cb9d725f5d1c">bbCloseDevice</a>(handle);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="ttc" id="abb__api_8h_html_a1d5030d8a63472fecee13a624c3f17ea"><div class="ttname"><a href="bb__api_8h.html#a1d5030d8a63472fecee13a624c3f17ea">TG_THRU_0DB</a></div><div class="ttdeci">#define TG_THRU_0DB</div><div class="ttdef"><b>Definition:</b> bb_api.h:274</div></div>
<div class="ttc" id="abb__api_8h_html_a2363fd94e54b6561fdb60902c789a49d"><div class="ttname"><a href="bb__api_8h.html#a2363fd94e54b6561fdb60902c789a49d">bbAttachTg</a></div><div class="ttdeci">BB_API bbStatus bbAttachTg(int device)</div></div>
<div class="ttc" id="abb__api_8h_html_a6439afedb8069eb699b1d9bae0ceed84"><div class="ttname"><a href="bb__api_8h.html#a6439afedb8069eb699b1d9bae0ceed84">bbStoreTgThru</a></div><div class="ttdeci">BB_API bbStatus bbStoreTgThru(int device, int flag)</div></div>
<div class="ttc" id="abb__api_8h_html_a70350577bf029b1575273a91a1cb0859"><div class="ttname"><a href="bb__api_8h.html#a70350577bf029b1575273a91a1cb0859">BB_TG_SWEEPING</a></div><div class="ttdeci">#define BB_TG_SWEEPING</div><div class="ttdef"><b>Definition:</b> bb_api.h:138</div></div>
<div class="ttc" id="abb__api_8h_html_a71b852dd5871f9f14e290f7c0d2ef9cc"><div class="ttname"><a href="bb__api_8h.html#a71b852dd5871f9f14e290f7c0d2ef9cc">bbConfigTgSweep</a></div><div class="ttdeci">BB_API bbStatus bbConfigTgSweep(int device, int sweepSize, bool highDynamicRange, bool passiveDevice)</div></div>
<div class="ttc" id="abb__api_8h_html_adc139b5b443dc6d647e08a2a68155ca4"><div class="ttname"><a href="bb__api_8h.html#adc139b5b443dc6d647e08a2a68155ca4">BB_SPUR_REJECT</a></div><div class="ttdeci">#define BB_SPUR_REJECT</div><div class="ttdef"><b>Definition:</b> bb_api.h:143</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md52"></a>
Configuration and Usage</h2>
<p >Initialize the device with the <a class="el" href="bb__api_8h.html#a70350577bf029b1575273a91a1cb0859">BB_TG_SWEEPING</a> flag.</p>
<p >Scalar Network Analysis can be realized by following these steps:</p>
<ol type="1">
<li>Ensure the Signal Hound BB60 spectrum analyzer and tracking generator are connected to your PC.</li>
<li>Open the spectrum analyzer through the <a class="el" href="bb__api_8h.html#ab92ec1dec31d08f9a77d6ab057f4dd07">bbOpenDevice</a> function.</li>
<li>Associate a tracking generator to a spectrum analyzer by calling <a class="el" href="bb__api_8h.html#a2363fd94e54b6561fdb60902c789a49d">bbAttachTg</a>. At this point, if a TG is present, it is claimed by the API and cannot be discovered again until <a class="el" href="bb__api_8h.html#ac19bb704f9607149f4a8cb9d725f5d1c">bbCloseDevice</a> is called.</li>
<li>Configure the device as normal, setting sweep frequencies and reference level (or manually setting gain and attenuation).</li>
<li>Configure the TG sweep with the <a class="el" href="bb__api_8h.html#a71b852dd5871f9f14e290f7c0d2ef9cc">bbConfigTgSweep</a> function. This function configures TG sweep specific parameters.</li>
<li>Call bbInitiate with the <a class="el" href="bb__api_8h.html#a70350577bf029b1575273a91a1cb0859">BB_TG_SWEEPING</a> mode flag.</li>
<li>Get the sweep characteristics with <a class="el" href="bb__api_8h.html#a71b1e19fca5baaed630eaf31ab9055cd">bbQueryTraceInfo</a>.</li>
<li>Connect the BB and TG device into the final test state without the DUT and perform one sweep with <a class="el" href="bb__api_8h.html#a492c3115f997be85c305a5db9bbff12a">bbFetchTrace</a>. After one full sweep has returned, call <a class="el" href="bb__api_8h.html#a6439afedb8069eb699b1d9bae0ceed84">bbStoreTgThru</a> with the <a class="el" href="bb__api_8h.html#a1d5030d8a63472fecee13a624c3f17ea">TG_THRU_0DB</a> flag.</li>
<li>(Optional) Configure the setup again still without the DUT but with a 20dB pad inserted into the system. Perform an additional full sweep and call <a class="el" href="bb__api_8h.html#a6439afedb8069eb699b1d9bae0ceed84">bbStoreTgThru</a> with the <a class="el" href="bb__api_8h.html#a3aecf114a37218871c69b71744df6673">TG_THRU_20DB</a>.</li>
<li>Once store through has been called, insert your DUT into the system and then you can freely call the get sweep function until you modify the configuration or settings.</li>
</ol>
<p >If you modify the test setup or want to re-initialize the device with a new configuration, the store through must be performed again. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
